<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ [y] hybris Platform
  ~
  ~ Copyright (c) 2000-2015 hybris AG
  ~ All rights reserved.
  ~
  ~ This software is the confidential and proprietary information of hybris
  ~ ("Confidential Information"). You shall not disclose such Confidential
  ~ Information and shall use it only in accordance with the terms of the
  ~ license agreement you entered into with hybris.
  -->

<beans xmlns="http://www.springframework.org/schema/beans"
		 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xmlns:int="http://www.springframework.org/schema/integration"
		 xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration.xsd">

	<bean id="cwsProductFacade" parent="defaultProductFacade">
		<property name="productConfiguredPopulator" ref="cwsProductConfiguredPopulator"/>
		<property name="productConverter" ref="cwsProductConverter"/>
	</bean>

	<bean id="cwsProductConfiguredPopulator" parent="defaultProductConfiguredPopulator">
		<property name="populators">
			<map key-type="de.hybris.platform.commercefacades.product.ProductOption" merge="true">
				<entry key="GALLERY" value-ref="cwsProductGalleryPopulatorList"/>
			</map>
		</property>
	</bean>

	<bean id="cwsProductGalleryPopulatorList" parent="abstractPopulatorList">
		<property name="populators">
			<list>
				<ref bean="cwsProductGalleryImagesPopulator"/>
			</list>
		</property>
	</bean>

	<bean id="cwsImageFormatMapping" parent="defaultImageFormatMapping">
		<property name="mapping">
			<map>
				<entry key="superZoom" value="1200Wx1200H"/>
				<entry key="zoom" value="515Wx515H"/>
				<entry key="store" value="365Wx246H"/>
				<entry key="product" value="300Wx300H"/>
				<entry key="thumbnail" value="96Wx96H"/>
				<entry key="cartIcon" value="65Wx65H"/>
				<entry key="styleSwatch" value="30Wx30H"/>
			</map>
		</property>
	</bean>

	<bean id="cwsProductPrimaryImagePopulator" parent="defaultProductPrimaryImagePopulator">
		<property name="imageFormatMapping" ref="cwsImageFormatMapping"/>
		<property name="imageFormats">
			<list>
				<value>zoom</value>
				<value>product</value>
				<value>thumbnail</value>
				<value>cartIcon</value>
			</list>
		</property>
	</bean>

	<bean id="cwsProductGalleryImagesPopulator" parent="defaultProductGalleryImagesPopulator">
		<property name="imageFormatMapping" ref="cwsImageFormatMapping"/>
		<property name="imageFormats">
			<list>
				<value>zoom</value>
				<value>product</value>
				<value>thumbnail</value>
			</list>
		</property>
	</bean>

	<bean id="cwsProductPopulator"
			parent="defaultProductPopulator">
		<property name="productPrimaryImagePopulator" ref="cwsProductPrimaryImagePopulator"/>
		<property name="productModelUrlResolver" ref="marketplacewebservicesProductModelUrlResolver"/>
	</bean>

	<bean id="cwsProductConverter" parent="defaultProductConverter">
		<property name="populators">
			<list>
				<ref bean="cwsProductPopulator"/>
			</list>
		</property>
	</bean>

	<bean id="cwsCatalogFacade" parent="defaultCatalogFacade">
		<property name="catalogVersionPopulator" ref="cwsCatalogVersionPopulator"/>
		<property name="categoryHierarchyPopulator" ref="cwsCategoryHierarchyPopulator"/>
	</bean>

	<bean id="cwsCatalogVersionPopulator" parent="defaultCatalogVersionPopulator">
		<property name="categoryHierarchyPopulator" ref="cwsCategoryHierarchyPopulator"/>
		<property name="categoriesUrl" value="/categories"/>
	</bean>

	<bean id="cwsCategoryHierarchyPopulator" parent="defaultCategoryHierarchyPopulator">
		<property name="productConverter" ref="cwsProductConverter"/>
		<property name="categoryUrlResolver" ref="marketplacewebservicesCategoryModelUrlResolver"></property>
	</bean>

	<bean id="cwsProductExportFacade" parent="defaultProductExportFacade">
		<property name="productConverter" ref="cwsProductConverter"/>
		<property name="productCategoriesPopulator" ref="cwsProductCategoriesPopulator"/>
	</bean>

	<bean id="cwsProductCategoriesPopulator" parent="defaultProductCategoriesPopulator">
		<property name="categoryConverter" ref="cwsCategoryConverter"/>
	</bean>

	<bean id="cwsCategoryConverter" parent="defaultCategoryConverter">
		<lookup-method name="createTarget" bean="categoryData"/>
		<property name="populators">
			<list>
				<ref bean="cwsCategoryPopulator"/>
			</list>
		</property>
	</bean>

	<bean id="cwsCategoryPopulator" parent="defaultCategoryPopulator">
		<property name="categoryModelUrlResolver" ref="marketplacewebservicesCategoryModelUrlResolver"/>
	</bean>

	<bean id="marketplacewebservicesProductModelUrlResolver" parent="defaultProductModelUrlResolver">
		<property name="defaultPattern" value="/{baseSite-uid}/products/{product-code}"/>
	</bean>

	<bean id="marketplacewebservicesCategoryModelUrlResolver" parent="defaultCategoryModelUrlResolver">
		<property name="pattern" value="/{baseSite-uid}/catalogs/{catalog-id}/{catalogVersion}/categories/{category-code}"/>
	</bean>

	<alias name="defaultCommerceStockFacade" alias="commerceStockFacade"/>
	<bean id="defaultCommerceStockFacade" class="com.tisl.mpl.stock.impl.DefaultCommerceStockFacade">
		<property name="baseSiteService" ref="baseSiteService"/>
		<property name="commerceStockService" ref="commerceStockService"/>
		<property name="pointOfServiceService" ref="pointOfServiceService"/>
		<property name="productService" ref="productService"/>
		<property name="baseStoreForSiteSelectorStrategy" ref="baseStoreForSiteSelectorStrategy"/>
	</bean>

	<alias name="defaultBaseStoreForSiteSelectorStrategy" alias="baseStoreForSiteSelectorStrategy"/>
	<bean id="defaultBaseStoreForSiteSelectorStrategy"
			class="com.tisl.mpl.strategies.impl.DefaultBaseStoreForSiteSelectorStrategy"/>

	<bean id="commerceWebServicesCartFacade2" class="com.tisl.mpl.cart.impl.CommerceWebServicesCartFacade"
	      parent="defaultCartFacade">
		<property name="cartConverter" ref="extendedCartConverter"/>
		<property name="commerceCartService" ref="commerceWebServicesCartService"/>
	</bean>

	<!-- Populator for title name -->
	<alias name="defaultExtendedCustomerPopulator" alias="extendedCustomerPopulator"/>
	<bean id="defaultExtendedCustomerPopulator"
			class="com.tisl.mpl.customer.populator.ExtendedCustomerPopulator">
		<property name="addressConverter" ref="addressConverter"/>
	</bean>

	<bean parent="modifyPopulatorList">
		<property name="list" ref="customerConverter"/>
		<property name="add" ref="extendedCustomerPopulator"/>
	</bean>

	<!-- Update Queues -->

	<bean id="abstractUpdateQueue"
			class="com.tisl.mpl.queues.impl.AbstractUpdateQueue" abstract="true">
		<property name="maxCapacity" value="100000"/>
	</bean>

	<!--Express Update Queue functionality-->

	<bean id="productExpressUpdateQueue"
			class="com.tisl.mpl.queues.impl.ProductExpressUpdateQueue"
			parent="abstractUpdateQueue"/>

	<bean id="productExpressUpdateChannelListener"
			class="com.tisl.mpl.queues.channel.ProductExpressUpdateChannelListener">
		<property name="productExpressUpdateElementConverter" ref="productExpressUpdateElementConverter"/>
		<property name="productExpressUpdateQueue" ref="productExpressUpdateQueue"/>
	</bean>

	<int:service-activator input-channel="productExpressUpdateChannel"
								  ref="productExpressUpdateChannelListener"
								  method="onMessage"/>

	<bean id="productExpressUpdateElementData"
			class="com.tisl.mpl.queues.data.ProductExpressUpdateElementData" scope="prototype"/>

	<alias name="defaultProductExpressUpdateElementPopulator" alias="productExpressUpdateElementPopulator"/>
	<bean id="defaultProductExpressUpdateElementPopulator"
			class="com.tisl.mpl.queues.populators.ProductExpressUpdateElementPopulator"/>

	<alias name="defaultProductExpressUpdateElementConverter" alias="productExpressUpdateElementConverter"/>
	<bean id="defaultProductExpressUpdateElementConverter" parent="abstractPopulatingConverter">
		<lookup-method name="createTarget" bean="productExpressUpdateElementData"/>
		<property name="populators">
			<list>
				<ref bean="productExpressUpdateElementPopulator"/>
			</list>
		</property>
	</bean>

	<bean id="productExpressUpdateCleanerJob"
			class="com.tisl.mpl.queues.cronjob.ProductExpressUpdateCleanerJob"
			parent="abstractJobPerformable">
		<property name="productExpressUpdateQueue" ref="productExpressUpdateQueue"/>
	</bean>

	<!-- Order Status Update Queue -->

	<bean id="orderStatusUpdateQueue"
			class="com.tisl.mpl.queues.impl.OrderStatusUpdateQueue"
			parent="abstractUpdateQueue"/>

	<bean id="orderStatusUpdateChannelListener"
			class="com.tisl.mpl.queues.channel.OrderStatusUpdateChannelListener">
		<property name="orderStatusUpdateElementConverter" ref="orderStatusUpdateElementConverter"/>
		<property name="orderStatusUpdateQueue" ref="orderStatusUpdateQueue"/>
	</bean>

	<int:service-activator input-channel="orderStatusUpdateChannel"
								  ref="orderStatusUpdateChannelListener"
								  method="onMessage"/>

	<bean id="orderStatusUpdateElementData"
			class="com.tisl.mpl.queues.data.OrderStatusUpdateElementData" scope="prototype"/>

	<alias name="defaultOrderStatusUpdateElementPopulator" alias="orderStatusUpdateElementPopulator"/>
	<bean id="defaultOrderStatusUpdateElementPopulator"
			class="com.tisl.mpl.queues.populators.OrderStatusUpdateElementPopulator"/>

	<alias name="defaultProductExpressUpdateElementConverter" alias="orderStatusUpdateElementConverter"/>
	<bean id="defaultOrderStatusUpdateElementConverter" parent="abstractPopulatingConverter">
		<lookup-method name="createTarget" bean="orderStatusUpdateElementData"/>
		<property name="populators">
			<list>
				<ref bean="orderStatusUpdateElementPopulator"/>
			</list>
		</property>
	</bean>

	<bean id="orderStatusUpdateCleanerJob"
			class="com.tisl.mpl.queues.cronjob.OrderStatusUpdateCleanerJob"
			parent="abstractJobPerformable">
		<property name="orderStatusUpdateQueue" ref="orderStatusUpdateQueue"/>
	</bean>

	<!-- Old cart cleaner -->
	<bean id="oldCartRemovalJob" class="com.tisl.mpl.cronjob.OldCartRemovalJob"
			parent="abstractJobPerformable">
		<property name="commerceCartDao" ref="commerceCartDao"/>
		<property name="timeService" ref="timeService"/>
		<property name="userService" ref="userService"/>
	</bean>

    <alias alias="orderCodeIdentificationStrategy" name="defaultOrderCodeIdentificationStrategy"/>
    <bean id="defaultOrderCodeIdentificationStrategy" class="com.tisl.mpl.strategies.impl.DefaultOrderCodeIdentificationStrategy">
        <property name="idPattern" value="[0-9a-f]{40}|[0-9a-f-]{36}"/>
    </bean>
    

<!-- Priority -->
    <!-- <bean id="userAccessTrackingService"
			class="com.tisl.mpl.service.UserAccessTrackingService"/> -->
			<bean id="userAccessTrackingService"
			class="com.tisl.mpl.service.UserAccessTrackingServiceImpl"/>
	<!-- Priority -->	
	

<bean id="mplValidateAgainstXSDService"
			class="com.tisl.mpl.service.MplValidateAgainstXSDServiceImpl"/>
<bean id="mplSellerMasterService"
			class="com.tisl.mpl.service.MplSellerMasterServiceImpl"/>	
			
<bean id="mplSellerMasterDao"
			class="com.tisl.mpl.marketplacecommerceservices.daos.impl.MplSellerMasterDaoImpl"/>			
			
<bean id="mplSellerTypeGlobalCodesService"
			class="com.tisl.mpl.service.MplSellerTypeGlobalCodesServiceImpl"/>	
<bean id="mplSellerTypeGlobalCodesDAO"
			class="com.tisl.mpl.dao.MplSellerTypeGlobalCodesDAOImpl"/>		
			<!-- Shop by brand Mobile -->
<bean id="mplCustomBrandService"
			class="com.tisl.mpl.service.impl.MplCustomBrandServiceImpl"/>
			<!-- Shop by brand Mobile -->
			<!-- Shop by Dept Mobile -->
<bean id="mplCustomCategoryService"
			class="com.tisl.mpl.service.impl.MplCustomCategoryServiceImpl"/>
			<!-- Shop by Dept Mobile -->
<bean id="productCategoryPopulator"
			class="com.tisl.mpl.category.populator.ProductCategoryPopulator">
			<property name="categoryUrlResolver" ref="categoryModelUrlResolver"></property>
</bean>	
<bean id="homescreenservice"
			class="com.tisl.mpl.service.HomescreenServiceImpl"/>
	
<!-- For Tata Etail : SNS	 -->	
<bean id="searchSuggestUtilityMethods"
		class="com.tisl.mpl.utility.SearchSuggestUtilityMethods"/>
		
<bean id="mplBuyBoxUtility"
		class="com.tisl.mpl.util.MplBuyBoxUtility">
		<property name="buyBoxService" ref="buyBoxService" />
		<property name="variantOptionDataConverter" ref="variantOptionDataConverter" />
</bean>
<bean id="mplCompetingProductsUtility"
		class="com.tisl.mpl.util.MplCompetingProductsUtility">
</bean>				
<!-- Registration Mobile web service  -->		
<bean id="mobileusercreenservice"
			class="com.tisl.mpl.service.impl.MplMobileUserServiceImpl">
<property name="userDetailsService" ref="extendedUserDetailsService" />
</bean>	
<!-- Registration Mobile web service  -->	
<!-- ProductDetailsForProductCode mobile web service begins -->
<bean id="mplProductWebService"
		class="com.tisl.mpl.service.impl.MplProductWebServiceImpl"/>
<!-- ProductDetailsForProductCode mobile web service ends -->	
<!-- Push Notifications save device info starts-->
<bean id="mplMobileAppRegisterFacade"
		class="com.tisl.mpl.facade.impl.MplMobileAppRegisterFacadeImpl"/>
<bean id="mplMobileAppRegisterDao"
		class="com.tisl.mpl.dao.impl.MplMobileAppRegisterDaoImpl"/>
<bean id="mplMobileAppRegisterService"
		class="com.tisl.mpl.service.impl.MplMobileAppRegisterServiceImpl"/>
<!-- Push Notifications save device info ends-->		

<!-- PaymentDetails mobile web service ends -->
<bean id="mplPaymentWebFacade"
		class="com.tisl.mpl.facade.impl.MplPaymentWebFacadeImpl"/>
<bean id="mplPaymentWebService"
		class="com.tisl.mpl.service.MplPaymentWebServiceImpl"/>
<bean id="mplPaymentWebDAO"
		class="com.tisl.mpl.dao.MplPaymentWebDAOImpl"/>
<!-- PaymentDetails mobile web service ends -->
<!-- Restriction set up -->
<bean id="restrictionserviceimpl"
		class="com.tisl.mpl.service.MplRestrictionServiceImpl"/>
<!-- JSON Version Response starts -->		
		<bean id="mplVersionService"
		class="com.tisl.mpl.service.impl.MplVersionServiceImpl"/>
<!-- JSON Version Response ends -->	
<!-- Webhook -->
<bean id="mplPaymentWebHookFacade"
	class="com.tisl.mpl.facade.impl.MplPaymentWebHookFacadeImpl"/>
<bean id="MplPaymentWebHookService"
	class="com.tisl.mpl.service.impl.MplPaymentWebHookServiceImpl"/>
<!-- Webhook -->
<bean id="mplCartWebService"
		class="com.tisl.mpl.service.impl.MplCartWebServiceImpl">
<property name="productService" ref="productService"/>
<property name="baseSiteService" ref="baseSiteService" />
<property name="cartConverter" ref="cartConverter"/>
<property name="cartService" ref="cartService"/>
<property name="cartModificationConverter" ref="cartModificationConverter"/>
<property name="cartRestorationConverter" ref="cartRestorationConverter"/>
<property name="commerceCartService" ref="commerceCartService" />
<property name="miniCartConverter" ref="miniCartConverter"/>
<property name="pointOfServiceService" ref="pointOfServiceService"/>
<property name="userService" ref="userService"/>
</bean>	
<!-- For Promotion on Mobile cart -->

	<bean id="mplDiscountUtil" class="com.tisl.mpl.utility.MplDiscountUtil" />	
	
	<bean id="mplCouponWebFacade"
	class="com.tisl.mpl.facade.impl.MplCouponWebFacadeImpl"/>
	<bean id="mplCouponWebService"
	class="com.tisl.mpl.service.impl.MplCouponWebServiceImpl"/>					
	
	<bean id="mplSlaveMasterService" class="com.tisl.mpl.service.MplSlaveMasterServiceImpl"/>	
	<bean id="mplSlaveMasterDao" class="com.tisl.mpl.dao.MplSlaveMasterDAOImpl"/>

</beans>
